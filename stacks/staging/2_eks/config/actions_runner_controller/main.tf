resource "kubernetes_namespace_v1" "actions_runner_system" {
  metadata {
    name = "actions-runner-system"
  }
}

resource "kubernetes_manifest" "controller_manager_sealed_secret" {
  manifest = {
    "apiVersion" = "bitnami.com/v1alpha1"
    "kind"       = "SealedSecret"
    "metadata" = {
      "name"      = "controller-manager"
      "namespace" = kubernetes_namespace_v1.actions_runner_system.metadata[0].name
    }
    "spec" = {
      "encryptedData" = {
        "github_app_id"              = "AgCHjjWLui8KASsdoybZ6ucL5dJ1cvaYHVw8LIclWCmTNIHMxggP3ywjU1Huy61G5OUaMJ487CclnDE/UJbTs5xiOFLHZadiWFBDZ+Q0pX/OgW1agVQ/K3WJPLdsZNoNjhuBHIHqX4VGFuLR3G171oJoMv74w2Q84F7vO2hU3TVsZrl3msPOChTcxm9mwTF61a8VoYYNnr/+SITD4Kfh5OpUZCfDxNw3VTQxrnOsPsesnHted2jFvRZaWqOy8q3MA7Ie72vwekUBvGJ2ZTLZnkDQth9+8W89WXYvqV8iVPpYMt1mEs/kPzHAX2s+XCxvgqVX8bAz2Gj1AM/152gDSUiWtnGRc5kbIDUUoqD+yPTOJI8+aEcolun3bOCkAR61g2ZTfPJgotUzdYoXnqw9mO6+lGPJxqKHVn1f514WNkCqKIW6s7utd23ZSG/RFGUL8VQBTNJiS+jmSxFEVtceMCd/7kkQYk8UAau+WQiLOqHGmphjw3KfqHQhcqb9+oR8cRwGFEOgbJViuqO0sDkVeEdmpv+mI/Sbbi7RkDaER2F1cMHh5ZaTU/Ykyfp9S7piIZQLF7io5cHqcxrgsPloLpXGDT2odgvoEKQnvpQXzx5/uskIfm2J35Ng+z7f1S+fr0L2DnKZL7hnAcUCT/qIeMQyMYAyyM8+fUfQvQbnfHEIae802Owy4uR5hL8QL1kcfts6WwLKNuw="
        "github_app_installation_id" = "AgBWyFgnN/JTp9CNNz/JwBuxhIxy9CM8GTdSkyEDO+2WmdtT30jL4seNFTD09gx8AEkXTNgPnW64+OQhSxuvaXLn2J7EoBP52IKqb9pUP3BuPSCMs5eAOv4YaSSJqMOuTx6Zmj4KluUNYprfcEkbW13mTUGCXtNvHrEQ0FzIHGLcubyGVlPvrEIUnbmm4FxOVWDNxS8ry8X46ixs7ccMupTr4Pn9qVz+YzVag5Us3SfBg2dmyqIWjXeYqzg/k1tJlqNxJkuPiCZ1ZFN2Po+dKwaAZnonsX4mSDMTfHtNtcdPrkAblmJXeAsMNoZnhBVtyYvv6Vf3N6zzqd56M7f9+Thb5t9Umu91cCHVMpys+6oP8Ylb/JXMqMXncApA68XRagXEBhCdxfKeTq5NZokBbY3sFPka9TT04JpJM21k610RO6r4QQrxu+dhQQHI3cBkGlTagl/7BoesKJWxOcJFfjc7OEIR/xi+WUo3tPH2dyx5PhHdrEkPjbU1JCAUCCLLwMwAxn0O+GcHxy8WFGkQLpLFb5t9relXJ9RyYAXc03NbX4ij/gcUz6XZl/i4pBAhG94zUmUcls0r04KqwX4f9znwxsvTj3sFyPdyxkW6fz9i7FjOjSq4qkXzgG56jR6TF5Jr6VdBZg4h0Zd1PpTs4MrEYBFhVAyquHfCESYkrOyzRxrgveXK+C2ipO6vPE7rviqYaNdYh7gdbA=="
        "github_app_private_key"     = "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"
      }
    }
  }
}

resource "helm_release" "actions_runner_controller" {
  name      = "actions-runner-controller"
  namespace = kubernetes_namespace_v1.actions_runner_system.metadata[0].name

  repository = "https://actions-runner-controller.github.io/actions-runner-controller"
  chart      = "actions-runner-controller"
  version    = "0.17.3"
}
